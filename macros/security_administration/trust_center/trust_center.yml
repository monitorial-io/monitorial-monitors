version: 2

macros:
  - name: CIS_BENCHMARKS_CIS1_1
    description: "Ensure single sign-on (SSO) is configured for your account / organization"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_1 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_2
    description: "Ensure Snowflake SCIM integration is configured to automatically provision and deprovision users and groups (i.e. roles)"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_2 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_3
    description: "Ensure that Snowflake password is unset for SSO users"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_3 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_4
    description: "Ensure multi-factor authentication (MFA) is turned on for all human users with password-based authentication"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_4 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_5
    description: "Ensure minimum password length is set to 14 characters or more"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_5 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_6
    description: "Ensure that service accounts use key pair authentication"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_6 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_7
    description: "Ensure authentication key pairs are rotated every 180 days"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_7 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_8
    description: "Ensure that users who did not log in for 90 days are disabled"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_8 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_9
    description: "Ensure that the idle session timeout is set to 15 minutes or less for users with the ACCOUNTADMIN and SECURITYADMIN roles"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_9 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_10
    description: "Limit the number of users with ACCOUNTADMIN and SECURITYADMIN"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_10 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_11
    description: "Ensure that all users granted the ACCOUNTADMIN role have an email address assigned"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_11 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_12
    description: "Ensure that no users have ACCOUNTADMIN or SECURITYADMIN as the default role"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_12 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_13
    description: "Ensure that the ACCOUNTADMIN or SECURITYADMIN role is not granted to any custom role"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_13 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_14
    description: "Ensure that Snowflake tasks are not owned by the ACCOUNTADMIN or SECURITYADMIN roles"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_14 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_15
    description: "Ensure that Snowflake tasks do not run with the ACCOUNTADMIN or SECURITYADMIN role privileges"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_15 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_16
    description: "Ensure that Snowflake stored procedures are not owned by the ACCOUNTADMIN or SECURITYADMIN roles"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_16 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS1_17
    description: "Ensure Snowflake stored procedures do not run with ACCOUNTADMIN or SECURITYADMIN role privileges"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS1_17 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS2_1
    description: "Ensure monitoring and alerting exist for ACCOUNTADMIN and SECURITYADMIN role grants"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS2_1 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS2_2
    description: "Ensure monitoring and alerting exist for MANAGE GRANTS privilege grants"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS2_2 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS2_3
    description: "Ensure monitoring and alerting exist for password sign-ins of SSO users"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS2_3 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS2_4
    description: "Ensure monitoring and alerting exist for password sign-in without MFA"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS2_4 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS2_5
    description: "Ensure monitoring and alerting exist for creation, update and deletion of security integrations"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS2_5 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS2_6
    description: "Ensure monitoring and alerting exist for changes to network policies and associated objects"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS2_6 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS2_7
    description: "Ensure monitoring and alerting exist for SCIM token creation"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS2_7 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS2_8
    description: "Ensure monitoring and alerting exists for new share exposures"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS2_8 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS2_9
    description: "Ensure monitoring and alerting exists for sessions from unsupported Snowflake Connector for Python and JDBC and ODBC drivers"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS2_9 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS3_1
    description: "Ensure that an account-level network policy has been configured to only allow access from trusted IP addresses"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS3_1 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS3_2
    description: "Ensure that user-level network policies have been configured for service accounts"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS3_2 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_1
    description: "Ensure yearly rekeying is enabled for a Snowflake account"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_1 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_1
    description: "Ensure yearly rekeying is enabled for a Snowflake account"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_1 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_2
    description: "Ensure AES encryption key size used to encrypt files stored in internal stages is set to 256 bits"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_2 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_3
    description: "Ensure that the DATA_RETENTION_TIME_IN_DAYS parameter is set to 90 for critical data"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_3 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_4
    description: "Ensure that the MIN_DATA_RETENTION_TIME_IN_DAYS account parameter is set to 7 or higher"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_4 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_5
    description: "Ensure that the REQUIRE_STORAGE_INTEGRATION_FOR_STAGE_CREATION account parameter is set to true"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_5 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_6
    description: "Ensure that the REQUIRE_STORAGE_INTEGRATION_FOR_STAGE_OPERATION account parameter is set to true"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_6 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_7
    description: "Ensure that all external stages have storage integrations"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_7 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_8
    description: "Ensure that the PREVENT_UNLOAD_TO_INLINE_URL account parameter is set to true"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_8 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_9
    description: "Ensure that Tri-Secret Secure is enabled for the Snowflake account"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_9 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_10
    description: "Ensure that data masking is enabled for sensitive data"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_10 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"

  - name: CIS_BENCHMARKS_CIS4_11
    description: "Ensure that row-access policies are configured for sensitive data"
    docs:
      show: true
    monitorial:
      version: 1.0.1
      defaults:
        schedule: "0 6 * * *"
        severity: "warning"
        message: "Trust Center - CIS_BENCHMARKS_CIS4_11 found an potential threat or vulnerability"
        message_type: "security"
        environment: "account"
	
	
	
	
	
	
	
	
	


  